<div class="main-table-wrapper overflow-auto shadow">
    <table class="table table-borderless table-fit table-striped table-hover account-operations-table" ts-wrapper ng-if="loaded">
        <thead class="thead-dark">
        <tr>
            <th ts-criteria="id|parseInt" ts-default scope="col" class="align-middle border-0"><span class="bi bi-gear mr-1" fire="{{companies+search}}" column-chooser="companyTable"></span>ID</th>
            <th ts-criteria="name|trim" scope="col" class="align-middle border-0" translate>NAME</th>
            <th ts-criteria="inn" scope="col" class="align-middle border-0 width-125" translate>INN</th>
            <th ts-criteria="description|trim" scope="col" class="align-middle border-0" translate>DESCRIPTION</th>
            <th ts-criteria="telegram" scope="col" class="align-middle border-0" translate>TELEGRAM</th>
            <th ts-criteria="utc" scope="col" class="align-middle border-0">UTC</th>
            <th ts-criteria="rfidInsertStatus" scope="col" class="align-middle border-0" translate>LIMIT_TYPE</th>
            <th ts-criteria="createdOn" scope="col" class="align-middle border-0" translate>REGISTRATION_DATE</th>
            <th ts-criteria="objectsCount|parseInt" scope="col" class="align-middle border-0" translate>OBJECTS_COUNT</th>
            <th ts-criteria="maxObjectsCount|parseInt" scope="col" class="align-middle border-0" translate="LICENCE"></th>
            <th ts-criteria="idChatTelegram" scope="col" class="align-middle border-0" translate>OWNER</th>
            <th ng-if="superUser" ts-criteria="contactPay" scope="col" class="align-middle border-0" translate>CONTACT_PAY</th>
            <th ng-if="superUser" ts-criteria="companyPay" scope="col" class="align-middle border-0" translate>COMPANY_PAY</th>
            <th ng-if="superUser" ts-criteria="contactClient" scope="col" class="align-middle border-0" translate>CONTACT_CLIENT</th>
            <th ng-if="superUser" ts-criteria="manager" scope="col" class="align-middle border-0" translate>MANAGER</th>
            <th ng-if="superUser" ts-criteria="payDate" scope="col" class="align-middle border-0" translate>PAY_DATE</th>
            <th ng-if="superUser" ts-criteria="dealer" scope="col" class="align-middle border-0" translate="DEALER">DEALER</th>
            <th scope="col" class="align-middle border-0"></th>
            <th scope="col" class="align-middle border-0"></th>
            <th scope="col" class="align-middle border-0"></th>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="company in companies | filter: search" ts-repeat ng-click="setCurrentCompany(company)"
            ng-class="currentCompany(company) ? 'badge-secondary' : ''">
            <td class="align-middle" ng-bind="company.id"></td>
            <td class="align-middle">
                <span ng-bind="company.name" ng-if="selectedCompany.id != company.id"></span>
                <div class="input-group" ng-if="selectedCompany.id == company.id && editable(company)">
                    <input minlength="1" type="text" class="form-control form-control-sm" ng-model="selectedCompany.name">
                </div>
            </td>
            <td class="align-middle">
                <span ng-bind="company.inn" ng-if="selectedCompany.id != company.id"></span>
                <div class="input-group" ng-if="selectedCompany.id == company.id && editable(company)">
                    <input minlength="1" type="text" class="form-control form-control-sm width-125" ng-model="selectedCompany.inn">
                </div>
            </td>
            <td class="align-middle">
                <span ng-bind="company.description" ng-if="selectedCompany.id != company.id"></span>
                <div class="input-group" ng-if="selectedCompany.id == company.id && editable(company)">
                    <input type="text" class="form-control form-control-sm" ng-model="selectedCompany.description">
                </div>
            </td>
            <td class="align-middle">
                <span ng-bind="company.telegram" ng-if="selectedCompany.id != company.id"></span>
                <div class="input-group" ng-if="selectedCompany.id == company.id && editable(company)">
                    <select type="text" class="form-control form-control-sm" ng-model="selectedCompany.telegram">
                        <option ng-repeat="user in users" value="{{user.telegram}}">{{user.usersName + ' ('+user.telegram+')'}}</option>
                    </select>
                </div>
            </td>
            <td class="align-middle width-50">
                <span ng-bind="company.utc" ng-if="selectedCompany.id != company.id"></span>
                <div class="input-group" ng-if="selectedCompany.id == company.id && editable(company)">
                    <input min="-12" max="12" type="number" class="form-control form-control-sm" ng-model="selectedCompany.utc">
                </div>
            </td>
            <td class="align-middle p-0">
                <div class="btn-group btn-group-toggle" data-toggle="buttons" ng-if="selectedCompany.id == company.id">
                    <button type="button" class="btn btn-sm btn-secondary" tooltip-append-to-body="true" uib-tooltip="{{'LIMIT_CARD'|translate}}" ng-click="selectedCompany.rfidInsertStatus = 0" ng-class="{'active':selectedCompany.rfidInsertStatus==0}"><i class="h5 bi bi-dash text-info"></i></button>
                    <button type="button" class="btn btn-sm btn-secondary" tooltip-append-to-body="true" uib-tooltip="{{'UNLIMITED_CARD'|translate}}" ng-click="selectedCompany.rfidInsertStatus = 1" ng-class="{'active':selectedCompany.rfidInsertStatus==1}"><i class="h5 bi bi-check text-success"></i></button>
                </div>
                <i ng-if="selectedCompany.id != company.id" class="h5 b" ng-class="statusClass(company.rfidInsertStatus)"></i>
            </td>
            <td class="align-middle" ng-bind="company.createdOn | date:'medium'"></td>
            <td class="align-middle width-25" ng-bind="company.objectsCount"></td>
            <td class="align-middle width-25" ng-bind="company.maxObjectsCount"></td>
            <td class="align-middle" ng-bind="company.idChatTelegram"></td>
            <td ng-if="superUser" class="align-middle width-50">
                <span ng-bind="company.contactPay" ng-if="selectedCompany.id != company.id"></span>
                <div class="input-group" ng-if="selectedCompany.id == company.id && editable(company)">
                    <input type="text" class="form-control form-control-sm" ng-model="selectedCompany.contactPay">
                </div>
            </td>
            <td ng-if="superUser" class="align-middle width-50">
                <span ng-bind="company.companyPay" ng-if="selectedCompany.id != company.id"></span>
                <div class="input-group" ng-if="selectedCompany.id == company.id && editable(company)">
                    <input type="text" class="form-control form-control-sm" ng-model="selectedCompany.companyPay">
                </div>
            </td>
            <td ng-if="superUser" class="align-middle width-50">
                <span ng-bind="company.contactClient" ng-if="selectedCompany.id != company.id"></span>
                <div class="input-group" ng-if="selectedCompany.id == company.id && editable(company)">
                    <input type="text" class="form-control form-control-sm" ng-model="selectedCompany.contactClient">
                </div>
            </td>
            <td ng-if="superUser" class="align-middle width-50">
                <span ng-bind="company.manager" ng-if="selectedCompany.id != company.id"></span>
                <div class="input-group" ng-if="selectedCompany.id == company.id && editable(company)">
                    <input type="text" class="form-control form-control-sm" ng-model="selectedCompany.manager">
                </div>
            </td>
            <td ng-if="superUser" class="align-middle width-50">
                <span ng-bind="company.payDate" ng-if="selectedCompany.id != company.id"></span>
                <div class="input-group" ng-if="selectedCompany.id == company.id && editable(company)">
                    <input type="text" class="form-control form-control-sm" ng-model="selectedCompany.payDate"
                           date-time ui-mask="9999-99-99" placeholder="YYYY-MM-DD" model-view-value="true">
                </div>
            </td>
            <td class="align-middle">
                <span ng-bind="company.dealerName" ng-if="selectedCompany.id != company.id"></span>
                <div class="input-group" ng-if="selectedCompany.id == company.id && editable(company)">
                    <select type="text" class="form-control form-control-sm" ng-model="selectedCompany.dealerId">
                        <option ng-repeat="dealer in dealers" value="{{dealer.id}}">{{dealer.companyName}}</option>
                    </select>
                </div>
            </td>
            <td ng-show="selectedCompany.id != company.id" class="align-middle width-25"><i role="button" ng-class="currentCompany(company) ? 'bi bi-star-fill' : 'bi  bi-star'" ng-click="setCurrentCompany(company)"></i></td>
            <td ng-show="selectedCompany.id != company.id" class="align-middle width-25"><i ng-if="editable(company)" role="button" class="bi bi-pencil" ng-click="$event.stopPropagation();editCompany(company)"></i></td>
            <td ng-show="selectedCompany.id != company.id" class="align-middle width-25"><i ng-if="editable(company)" role="button" class="bi bi-trash" ng-click="$event.stopPropagation();deleteCompany(company)"></i></td>
            <td ng-show="selectedCompany.id == company.id" colspan="3" class="align-middle">
              <div class="float-right" ng-click="$event.stopPropagation()">
                  <button class="btn btn-primary btn-sm" ng-click="saveCompany(company)"><i class="bi bi-check"></i></button>
                  <button class="btn btn-danger btn-sm" ng-click="cancelEdit()"><i class="bi bi-x"></i></button>
              </div>
            </td>
        </tr>
        <tr>
            <td></td>
            <td class="align-middle">
                <div class="input-group">
                    <input maxlength="100" type="text" class="form-control form-control-sm" ng-model="newCompany.name">
                </div>
            </td>
            <td colspan="17" class="align-middle">
                <button class="btn btn-success btn-sm" ng-disabled="!newCompany.name" ng-click="createCompany()"><i class="bi bi-plus"></i></button>
            </td>
        </tr>
        </tbody>
    </table>
</div>